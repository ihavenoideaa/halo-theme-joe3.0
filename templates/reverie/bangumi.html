<!doctype html>
<html
  lang="en"
  xmlns:th="http://www.thymeleaf.org"
  th:replace="~{modules/layout :: html(title = '追番 | '+${site.title},htmlType = sheet,header = null,leftSidebar = true,content = ~{::content}, head = null, footer = null)}"
>
  <th:block th:fragment="content">
    <body>
      <link rel="stylesheet" type="text/css" th:href="@{/assets/reverie/css/bangumi.css}" /> 
      <div id="Joe">
          <th:block th:replace="~{modules/macro/navbar :: navbar}" />
          <div
          class="joe_container joe_main_container"
          th:classappend="|${theme.config.theme.enable_show_in_up ? 'animated showInUp':''} ${theme.config.aside.aside_position == 'left' ? 'revert':''}|"
          >
          <div class="joe_main">
              <img class="back-image" src="/res/images/rebeca.png">
              <div class="joe_detail">
                  <h1 class="bangumi-page-title">追番列表</h1>
                    <blockquote class="bangumi-page-quote">
                        你是愿意当个无名之辈，一辈子安生，还是就算活不到三十岁，也要名流青史呢
                    </blockquote>
              <div class="bangumi-tabs">
                <a class="bangumi-tab theme-cursor" id="bangumi-tab1" href="javascript:;" rel="external" target="_self"
                   onclick="return false" data-pjax-state="">
                    想看
                    ([[${bangumiFinder.getDataTotal(1,1)}]])</a>
                <a class="bangumi-tab theme-cursor bangumi-active" id="bangumi-tab2" href="javascript:;" rel="external"
                   target="_self" onclick="return false" data-pjax-state="">
                    在看
                    ([[${bangumiFinder.getDataTotal(1,2)}]])</a>
                <a class="bangumi-tab theme-cursor" id="bangumi-tab3" href="javascript:;" rel="external" target="_self"
                   onclick="return false" data-pjax-state="">
                    已看
                    ([[${bangumiFinder.getDataTotal(1,3)}]])</a>
            </div>

            <div class="bangumi-content">
              <div id="bangumi-item1" class="bangumi-hide">
                  <th:block th:replace="~{reverie/widgets/bangumi-item :: bangumi-item(${bangumiFinder.getBiliDataAll(1,1)})}"/>
              </div>
              <div id="bangumi-item2" class="bangumi-hide">
                  <th:block th:replace="~{reverie/widgets/bangumi-item :: bangumi-item(${bangumiFinder.getBiliDataAll(1,2)})}"/>
              </div>
              <div id="bangumi-item3" class="bangumi-hide">
                  <th:block th:replace="~{reverie/widgets/bangumi-item :: bangumi-item(${bangumiFinder.getBiliDataAll(1,3)})}"/>
              </div>
          </div>
          <script>
              (function () {
                  const bangumiLazyload = false;
                  "use strict";/* eslint-disable no-plusplus */
                  (function () {// eslint-disable-next-line func-style
                      function a() {
                          this.classList.add("bangumi-active");
                          for (var a = this.siblings(), b = 0; b < a.length; b++) a[b].classList.remove("bangumi-active");// 显示对应板块
                          var c = this.id.replace("tab", "item"), d = document.getElementById(c);
                          d.classList.remove("bangumi-hide"), d.classList.add("bangumi-show"), a = document.getElementById(c).siblings();
                          for (var e = 0; e < a.length; e++) a[e].classList.remove("bangumi-show"), a[e].classList.add("bangumi-hide")
                      }

                      Element.prototype.siblings = function () {
                          for (var a = [], b = this.parentNode.children, c = 0; c < b.length; c++) b[c] !== this && a.push(b[c]);
                          return a
                      };
                      for (var b = document.getElementsByClassName("bangumi-tab"), c = 0; c < b.length; c++) b[c].onclick = a, b[c].onclick.apply(b[c]);
                      "undefined" != typeof pagenumsPre && axios.get(new URL("../bangumis.json", window.location.href)).then(function (a) {
                          if (a.data) {
                              var b = {
                                  wantWatch: a.data.wantWatch.slice(10).map(function (a) {
                                      return ejs.render(ejsTemplate, {
                                          item: a,
                                          loading: loading,
                                          metaColor: metaColor,
                                          type: type
                                      })
                                  }).join("\n"), watching: a.data.watching.slice(10).map(function (a) {
                                      return ejs.render(ejsTemplate, {
                                          item: a,
                                          loading: loading,
                                          metaColor: metaColor,
                                          type: type
                                      })
                                  }).join("\n"), watched: a.data.watched.slice(10).map(function (a) {
                                      return ejs.render(ejsTemplate, {
                                          item: a,
                                          loading: loading,
                                          metaColor: metaColor,
                                          type: type
                                      })
                                  }).join("\n")
                              };
                              document.querySelectorAll("#bangumi-item1>.bangumi-pagination")[0].insertAdjacentHTML("beforeBegin", b.wantWatch), document.querySelectorAll("#bangumi-item2>.bangumi-pagination")[0].insertAdjacentHTML("beforeBegin", b.watching), document.querySelectorAll("#bangumi-item3>.bangumi-pagination")[0].insertAdjacentHTML("beforeBegin", b.watched)
                          }
                      })
                  })();
                  document.getElementsByClassName('bangumi-tab')[1].click();
                  /* eslint-disable no-plusplus, func-style */
                  (function () {
                      var a = Math.ceil;

                      function b(b, c) {
                          return `${b + 1} / ${a(0 == c.length / 10 ? 1 : a(c.length / 10))}`
                      }

                      function c() {
                          const a = this.parentNode.siblings();
                          g(a, 0), this.parentNode.getElementsByClassName("bangumi-pagenum")[0].innerText = b(0, a)
                      }

                      function d() {
                          const a = this.parentNode.siblings();
                          let c = this.parentNode.getElementsByClassName("bangumi-pagenum")[0].innerText;
                          c = c.substr(0, c.indexOf("/") - 1), c = parseInt(c, 10) - 1, 0 < c && c--, g(a, c), this.parentNode.getElementsByClassName("bangumi-pagenum")[0].innerText = b(c, a)
                      }

                      function e() {
                          const c = this.parentNode.siblings();
                          let d = this.parentNode.getElementsByClassName("bangumi-pagenum")[0].innerText;
                          d = d.substr(0, d.indexOf("/") - 1), d = parseInt(d, 10) - 1, d < a(c.length / 10) - 1 && d++, g(c, d), this.parentNode.getElementsByClassName("bangumi-pagenum")[0].innerText = b(d, c)
                      }

                      function f() {
                          const c = this.parentNode.siblings();
                          g(c, a(c.length / 10) - 1), this.parentNode.getElementsByClassName("bangumi-pagenum")[0].innerText = b(-1 == a(c.length / 10) - 1 ? 0 : a(c.length / 10) - 1, c)
                      }

                      function g(a, b) {
                          for (let c = 0; c < a.length; c++) if (Math.floor(c / 10) === b) {
                              a[c].classList.remove("bangumi-hide");
                              const [b] = a[c].getElementsByTagName("img");
                              bangumiLazyload && (b.src = b.getAttribute("data-src"))
                          } else a[c].classList.add("bangumi-hide")
                      }

                      const h = document.getElementsByClassName("bangumi-firstpage"),
                          j = document.getElementsByClassName("bangumi-previouspage"),
                          k = document.getElementsByClassName("bangumi-nextpage"),
                          l = document.getElementsByClassName("bangumi-lastpage"),
                          m = document.getElementsByClassName("bangumi-pagenum");
                      for (let b = 0; b < h.length; b++) {
                          h[b].onclick = c, j[b].onclick = d, k[b].onclick = e, l[b].onclick = f;// set page num
                          const g = "undefined" == typeof pagenumsPre ? m[b].parentNode.siblings().length : pagenumsPre[b] ?? m[b].parentNode.siblings().length;
                          h[b].click(), m[b].innerText = `1 / ${0 === a(g / 10) ? 1 : a(g / 10)}`
                      }
                  })();
              })();
          </script>

            </div>
          </div>
          <th:block th:if="${theme.config.aside.enable_friends_aside}">
            <th:block th:replace="~{modules/common/aside :: aside}" />
          </th:block>
        </div>
        <th:block th:replace="~{modules/common/actions :: actions}" />
        <th:block th:replace="~{modules/common/footer :: footer}" />
      </div>
      <th:block th:replace="~{modules/macro/tail :: tail}" />
    </body>
  </th:block>
</html>
